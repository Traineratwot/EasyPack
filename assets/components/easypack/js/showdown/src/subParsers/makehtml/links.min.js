
(function(){function replaceAnchorTag(rgx,evtRootName,options,globals,emptyCase){emptyCase=!!emptyCase;return function(wholeMatch,text,id,url,m5,m6,title){if(/\n\n/.test(wholeMatch)){return wholeMatch;}
var evt=createEvent(rgx,evtRootName+'.captureStart',wholeMatch,text,id,url,title,options,globals);return writeAnchorTag(evt,options,globals,emptyCase);};}
function createEvent(rgx,evtName,wholeMatch,text,id,url,title,options,globals){return globals.converter._dispatch(evtName,wholeMatch,options,globals,{regexp:rgx,matches:{wholeMatch:wholeMatch,text:text,id:id,url:url,title:title}});}
function writeAnchorTag(evt,options,globals,emptyCase){var wholeMatch=evt.getMatches().wholeMatch;var text=evt.getMatches().text;var id=evt.getMatches().id;var url=evt.getMatches().url;var title=evt.getMatches().title;var target='';if(!title){title='';}
id=(id)?id.toLowerCase():'';if(emptyCase){url='';}else if(!url){if(!id){id=text.toLowerCase().replace(/ ?\n/g,' ');}
url='#'+id;if(!showdown.helper.isUndefined(globals.gUrls[id])){url=globals.gUrls[id];if(!showdown.helper.isUndefined(globals.gTitles[id])){title=globals.gTitles[id];}}else{return wholeMatch;}}
url=url.replace(showdown.helper.regexes.asteriskDashTildeAndColon,showdown.helper.escapeCharactersCallback);if(title!==''&&title!==null){title=title.replace(/"/g,'&quot;');title=title.replace(showdown.helper.regexes.asteriskDashTildeAndColon,showdown.helper.escapeCharactersCallback);title=' title="'+title+'"';}
if(options.openLinksInNewWindow&&!/^#/.test(url)){target=' rel="noopener noreferrer" target="¨E95Eblank"';}
text=showdown.subParser('makehtml.codeSpans')(text,options,globals);text=showdown.subParser('makehtml.emoji')(text,options,globals);text=showdown.subParser('makehtml.underline')(text,options,globals);text=showdown.subParser('makehtml.italicsAndBold')(text,options,globals);text=showdown.subParser('makehtml.strikethrough')(text,options,globals);text=showdown.subParser('makehtml.ellipsis')(text,options,globals);text=showdown.subParser('makehtml.hashHTMLSpans')(text,options,globals);var result='<a href="'+url+'"'+title+target+'>'+text+'</a>';result=showdown.subParser('makehtml.hashHTMLSpans')(result,options,globals);return result;}
var evtRootName='makehtml.links';showdown.subParser('makehtml.links',function(text,options,globals){text=globals.converter._dispatch(evtRootName+'.start',text,options,globals).getText();text=showdown.subParser('makehtml.links.reference')(text,options,globals);text=showdown.subParser('makehtml.links.inline')(text,options,globals);text=showdown.subParser('makehtml.links.referenceShortcut')(text,options,globals);text=showdown.subParser('makehtml.links.angleBrackets')(text,options,globals);text=showdown.subParser('makehtml.links.ghMentions')(text,options,globals);text=text.replace(/<a\s[^>]*>[\s\S]*<\/a>/g,function(wholeMatch){return showdown.helper._hashHTMLSpan(wholeMatch,globals);});text=text.replace(/<img\s[^>]*\/?>/g,function(wholeMatch){return showdown.helper._hashHTMLSpan(wholeMatch,globals);});text=showdown.subParser('makehtml.links.naked')(text,options,globals);text=globals.converter._dispatch(evtRootName+'.end',text,options,globals).getText();return text;});showdown.subParser('makehtml.links.inline',function(text,options,globals){var evtRootName=evtRootName+'.inline';text=globals.converter._dispatch(evtRootName+'.start',text,options,globals).getText();var rgxEmpty=/\[(.*?)]()()()()\(<? ?>? ?(?:["'](.*)["'])?\)/g;text=text.replace(rgxEmpty,replaceAnchorTag(rgxEmpty,evtRootName,options,globals,true));var rgxCrazy=/\[((?:\[[^\]]*]|[^\[\]])*)]()\s?\([ \t]?<([^>]*)>(?:[ \t]*((["'])([^"]*?)\5))?[ \t]?\)/g;text=text.replace(rgxCrazy,replaceAnchorTag(rgxCrazy,evtRootName,options,globals));var rgx2=/\[([\S ]*?)]\s?()\( *<?([^\s'"]*?(?:\([\S]*?\)[\S]*?)?)>?\s*(?:()(['"])(.*?)\5)? *\)/g;text=text.replace(rgx2,replaceAnchorTag(rgx2,evtRootName,options,globals));var rgx3=/\[([\S ]*?)]\s?()\( *<?([^\s'"]*?(?:\([\S]*?\)[\S]*?)?)>?\s+()()\((.*?)\) *\)/g;text=text.replace(rgx3,replaceAnchorTag(rgx3,evtRootName,options,globals));text=globals.converter._dispatch(evtRootName+'.end',text,options,globals).getText();return text;});showdown.subParser('makehtml.links.reference',function(text,options,globals){var evtRootName=evtRootName+'.reference';text=globals.converter._dispatch(evtRootName+'.start',text,options,globals).getText();var rgx=/\[((?:\[[^\]]*]|[^\[\]])*)] ?(?:\n *)?\[(.*?)]()()()()/g;text=text.replace(rgx,replaceAnchorTag(rgx,evtRootName,options,globals));text=globals.converter._dispatch(evtRootName+'.end',text,options,globals).getText();return text;});showdown.subParser('makehtml.links.referenceShortcut',function(text,options,globals){var evtRootName=evtRootName+'.referenceShortcut';text=globals.converter._dispatch(evtRootName+'.start',text,options,globals).getText();var rgx=/\[([^\[\]]+)]()()()()()/g;text=text.replace(rgx,replaceAnchorTag(rgx,evtRootName,options,globals));text=globals.converter._dispatch(evtRootName+'.end',text,options,globals).getText();return text;});showdown.subParser('makehtml.links.ghMentions',function(text,options,globals){var evtRootName=evtRootName+'ghMentions';if(!options.ghMentions){return text;}
text=globals.converter._dispatch(evtRootName+'.start',text,options,globals).getText();var rgx=/(^|\s)(\\)?(@([a-z\d]+(?:[a-z\d._-]+?[a-z\d]+)*))/gi;text=text.replace(rgx,function(wholeMatch,st,escape,mentions,username){if(escape==='\\'){return st+mentions;}
if(!showdown.helper.isString(options.ghMentionsLink)){throw new Error('ghMentionsLink option must be a string');}
var url=options.ghMentionsLink.replace(/{u}/g,username);var evt=createEvent(rgx,evtRootName+'.captureStart',wholeMatch,mentions,null,url,null,options,globals);return st+writeAnchorTag(evt,options,globals);});text=globals.converter._dispatch(evtRootName+'.end',text,options,globals).getText();return text;});showdown.subParser('makehtml.links.angleBrackets',function(text,options,globals){var evtRootName='makehtml.links.angleBrackets';text=globals.converter._dispatch(evtRootName+'.start',text,options,globals).getText();var urlRgx=/<(((?:https?|ftp):\/\/|www\.)[^'">\s]+)>/gi;text=text.replace(urlRgx,function(wholeMatch,url,urlStart){var text=url;url=(urlStart==='www.')?'http://'+url:url;var evt=createEvent(urlRgx,evtRootName+'.captureStart',wholeMatch,text,null,url,null,options,globals);return writeAnchorTag(evt,options,globals);});var mailRgx=/<(?:mailto:)?([-.\w]+@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)>/gi;text=text.replace(mailRgx,function(wholeMatch,mail){var url='mailto:';mail=showdown.subParser('makehtml.unescapeSpecialChars')(mail,options,globals);if(options.encodeEmails){url=showdown.helper.encodeEmailAddress(url+mail);mail=showdown.helper.encodeEmailAddress(mail);}else{url=url+mail;}
var evt=createEvent(mailRgx,evtRootName+'.captureStart',wholeMatch,mail,null,url,null,options,globals);return writeAnchorTag(evt,options,globals);});text=globals.converter._dispatch(evtRootName+'.end',text,options,globals).getText();return text;});showdown.subParser('makehtml.links.naked',function(text,options,globals){if(!options.simplifiedAutoLink){return text;}
var evtRootName='makehtml.links.naked';text=globals.converter._dispatch(evtRootName+'.start',text,options,globals).getText();var urlRgx=/([_*~]*?)(((?:https?|ftp):\/\/|www\.)[^\s<>"'`´.-][^\s<>"'`´]*?\.[a-z\d.]+[^\s<>"']*)\1/gi;text=text.replace(urlRgx,function(wholeMatch,leadingMDChars,url,urlPrefix){var len=url.length;var suffix='';for(var i=len-1;i>=0;--i){var char=url.charAt(i);if(/[_*~,;:.!?]/.test(char)){url=url.slice(0,-1);suffix=char+suffix;}else if(/\)/.test(char)){var opPar=url.match(/\(/g)||[];var clPar=url.match(/\)/g);if(opPar.length<clPar.length){url=url.slice(0,-1);suffix=char+suffix;}else{break;}}else if(/]/.test(char)){var opPar2=url.match(/\[/g)||[];var clPar2=url.match(/\]/g);if(opPar2.length<clPar2.length){url=url.slice(0,-1);suffix=char+suffix;}else{break;}}else{break;}}
var text=url;url=(urlPrefix==='www.')?'http://'+url:url;text=text.replace(showdown.helper.regexes.asteriskDashTildeAndColon,showdown.helper.escapeCharactersCallback);var evt=createEvent(urlRgx,evtRootName+'.captureStart',wholeMatch,text,null,url,null,options,globals);return leadingMDChars+writeAnchorTag(evt,options,globals)+suffix+leadingMDChars;});var mailRgx=/(^|\s)(?:mailto:)?([A-Za-z0-9!#$%&'*+-/=?^_`{|}~.]+@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)(?=$|\s)/gmi;text=text.replace(mailRgx,function(wholeMatch,leadingChar,mail){var url='mailto:';mail=showdown.subParser('makehtml.unescapeSpecialChars')(mail,options,globals);if(options.encodeEmails){url=showdown.helper.encodeEmailAddress(url+mail);mail=showdown.helper.encodeEmailAddress(mail);}else{url=url+mail;}
var evt=createEvent(mailRgx,evtRootName+'.captureStart',wholeMatch,mail,null,url,null,options,globals);return leadingChar+writeAnchorTag(evt,options,globals);});text=globals.converter._dispatch(evtRootName+'.end',text,options,globals).getText();return text;});})();



